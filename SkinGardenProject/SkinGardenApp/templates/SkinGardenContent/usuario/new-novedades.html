{% extends "SkinGardenContent/usuario/encabezado.html" %}

{% load static %}


{% block content %}
        <nav class="responsive-main" onclick='encojerBuscador()'>
            <div class="ctn-banner-new">
                <img src="{% static 'SkinGardenContent/imagenes/logo-banners/banner-prod.png' %}" alt="Banner de Novedades" class="banner-new">
            </div>
            <a href="{% url 'novedades/usuario' %}">
                <img src="{% static 'SkinGardenContent/imagenes/iconos/volver-atras.png' %}" alt="Volver atras" class="volver-atras new-novedades-volver-atras" title="Volver Atras">
            </a>
        </nav> 
        <main onclick="cerrarMenuAbierto(), cerrarCarritoCompra(), encojerBuscador()">
            <section class="anti-imperfecciones">
                <div class="filasP">
                    {% for ver in newnovedades %}
                    <div class="bgCajas responsiveCajas">
                        <!-- Formulario para agregar al carrito -->
                        <form action="{% url 'agregar_al_carrito' producto_id=ver.id_productos %}" method="post">
                            {% csrf_token %}
                            <button type="submit" class="btn-agregar">
                                <img src="{% static 'SkinGardenContent/imagenes/iconos/añadir-carrito.png' %}"
                                    alt="Añadir al carrito" class="addCarrito" onclick="agregarAlCarrito()">
                            </button>
            
                            <!-- Etiqueta "NEW" para productos nuevos -->
                            <p class="discount">NEW</p>
            
                            <!-- Imagen del producto -->
                            <figure class="figureCaja">
                                <a href="{% url 'producto/usuario' producto_id=ver.id_productos %}" class="links">
                                    {% if ver.imagen %}
                                        <img src="{{ ver.imagen.url }}" alt="{{ ver.nom_producto }}" class="imagenesP" title="{{ ver.nom_producto }}">
                                    {% else %}
                                        <img src="{% static 'SkinGardenContent/imagenes/productos/img-default.jpg' %}" alt="Imagen no disponible" class="imagenesP">
                                    {% endif %}
                                </a>
                            </figure>
            
                            <!-- Información del producto -->
                            <div class="productInfo">
                                <h2 class="productName">{{ ver.nom_producto }}</h2>
                                <p class="infoProduct">{{ ver.descripcion }}</p>
                            </div>
            
                            <!-- Precio del producto con descuento, si aplica -->
                            <div class="ofertas-p">
                                {% if ver.totalDescuento != ver.precio %}
                                <p class="antiguoP">RD$ {{ ver.precio }}</p>
                                <p class="nuevoP">RD$ {{ ver.totalDescuento }}</p>
                                {% else %}
                                <p class="precio">RD$ {{ ver.precio }}</p>
                                {% endif %}
                            </div>
            
                            <!-- Calificación del producto -->
                            <figure class="qualyRates">
                                <p>{{ ver.calificacion }}</p>
                            </figure>
            
                            <!-- Campo oculto para cantidad (valor predeterminado a 1) -->
                            <input type="hidden" name="cantidad" value="1">
                        </form>
                    </div>
                    {% empty %}
                    <p>No hay productos en esta categoría.</p>
                    {% endfor %}
                </div>
            </section>
        </main>
{% endblock %}
